#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f main.sh -o /Users/donaldmoore/bin/update 
#endif

static  char data [] = 
#define      pswd_z	256
#define      pswd	((&data[64]))
	"\372\202\142\214\140\101\173\117\125\334\272\122\155\137\035\177"
	"\146\167\344\021\314\236\145\215\064\230\246\224\314\061\202\231"
	"\245\167\360\367\045\303\103\356\064\212\032\320\346\255\062\067"
	"\041\141\163\321\062\061\225\153\136\170\304\201\057\233\270\206"
	"\342\073\232\065\034\354\257\253\206\334\312\250\122\236\353\355"
	"\165\247\377\300\310\343\234\242\354\322\306\050\342\022\150\257"
	"\353\336\266\250\364\125\216\223\135\032\135\202\035\131\040\064"
	"\251\142\365\361\251\013\006\002\304\360\266\312\254\126\163\332"
	"\365\025\033\104\124\131\346\037\014\130\347\370\007\334\314\255"
	"\161\103\176\303\312\211\173\217\002\134\124\040\003\327\017\122"
	"\017\032\137\210\353\101\007\323\022\322\363\162\016\133\004\226"
	"\376\260\217\375\306\000\250\151\354\107\072\214\243\352\070\106"
	"\260\244\226\214\116\235\347\326\075\052\320\222\321\171\124\102"
	"\330\324\230\333\277\103\215\035\033\262\166\114\171\223\320\205"
	"\152\174\145\133\257\367\121\221\115\005\014\174\376\114\116\042"
	"\124\252\233\101\150\333\020\154\343\071\373\320\225\143\004\251"
	"\047\367\047\222\025\042\125\074\236\106\372\127\204\367\315\360"
	"\120\344\301\307\146\024\176\137\114\024\132\154\174\357\364\147"
	"\255\327\006\273\270\237\322\177\144\311\366\246\247\210\156\377"
	"\166\301\124\145\202\341\006\327\037\124\103\263\335\276\070\253"
	"\212\015\220\255\033\123\261\304\014\363\236\153\003\246"
#define      text_z	5602
#define      text	((&data[1419]))
	"\050\133\267\120\210\043\053\110\251\044\135\314\164\235\300\152"
	"\052\105\356\066\150\341\173\122\230\241\265\141\177\270\224\151"
	"\224\376\013\177\124\200\311\366\234\016\344\351\155\322\331\112"
	"\131\103\366\217\347\352\372\162\376\324\036\072\127\045\033\152"
	"\145\256\024\376\173\133\315\376\360\312\130\305\100\332\257\214"
	"\234\225\371\046\322\135\276\243\032\251\017\161\175\265\355\345"
	"\115\222\213\150\132\306\004\175\357\336\306\260\255\215\242\123"
	"\307\232\017\275\064\275\232\201\244\044\261\167\226\300\366\231"
	"\332\254\330\032\263\220\007\141\326\273\043\066\122\125\347\365"
	"\073\041\321\174\203\344\010\173\174\266\361\043\364\374\354\123"
	"\206\111\150\162\007\233\175\204\013\350\302\170\370\325\333\170"
	"\220\252\020\331\210\343\036\062\033\255\066\064\016\366\233\135"
	"\206\061\355\136\313\126\227\344\140\316\054\373\035\141\276\166"
	"\031\225\304\360\301\215\314\341\172\366\330\122\170\151\322\065"
	"\203\372\360\226\166\217\357\112\041\272\005\065\363\250\241\264"
	"\125\303\376\012\333\266\162\265\350\221\017\125\064\117\107\207"
	"\145\201\313\066\276\253\357\213\012\032\360\200\253\043\052\365"
	"\143\217\231\063\335\341\343\203\361\057\345\115\200\037\052\315"
	"\010\235\310\343\207\141\374\107\165\224\141\232\051\070\326\011"
	"\265\143\342\143\226\055\156\251\153\152\014\034\334\115\227\123"
	"\017\246\334\120\243\063\047\321\017\263\201\357\342\027\306\343"
	"\376\347\010\370\021\156\250\221\322\205\157\146\016\022\216\246"
	"\376\027\022\212\263\041\223\346\165\200\173\102\324\176\002\300"
	"\063\330\213\124\161\131\265\213\201\063\107\003\260\026\243\305"
	"\300\001\357\017\353\104\223\306\036\376\041\040\133\155\151\242"
	"\375\364\251\222\315\016\053\327\041\150\252\172\250\241\113\211"
	"\371\334\323\061\011\124\152\111\124\036\171\320\054\124\164\264"
	"\142\330\364\156\175\042\052\157\140\041\124\335\220\265\010\217"
	"\244\211\023\025\227\215\336\347\244\270\345\351\241\273\034\336"
	"\372\007\321\130\143\017\010\177\022\037\331\313\127\304\205\263"
	"\366\326\004\115\253\212\042\306\042\152\057\213\336\212\373\241"
	"\036\307\113\272\126\076\150\127\333\176\367\271\014\361\371\331"
	"\047\317\007\335\323\062\065\177\033\036\114\145\326\263\275\276"
	"\306\323\247\220\132\330\255\074\321\203\113\170\125\165\205\232"
	"\376\017\341\330\041\166\377\350\013\220\105\157\372\157\150\357"
	"\144\245\076\264\106\034\360\023\373\071\373\054\175\146\256\211"
	"\242\142\312\114\067\012\074\071\177\333\202\331\225\061\275\157"
	"\153\336\357\303\370\122\335\016\122\077\035\033\245\006\336\343"
	"\125\172\075\163\031\060\062\272\000\030\213\246\336\174\075\175"
	"\132\212\157\345\156\071\365\042\115\043\267\122\046\302\126\133"
	"\022\213\004\303\044\050\175\336\326\340\163\277\067\323\014\025"
	"\363\010\025\214\004\112\241\132\124\100\155\212\363\236\221\355"
	"\212\121\212\037\200\101\073\226\155\027\325\060\257\177\321\324"
	"\044\004\365\100\075\070\346\013\022\331\362\341\320\013\063\057"
	"\063\043\347\320\041\311\314\013\034\345\064\304\204\035\226\011"
	"\143\233\026\264\115\374\375\022\301\211\137\123\276\070\045\372"
	"\063\221\005\363\132\346\313\350\155\233\126\225\013\044\220\034"
	"\011\302\200\330\310\326\134\027\177\251\352\223\126\350\373\144"
	"\257\142\045\144\123\155\374\020\373\343\325\235\335\167\072\042"
	"\241\251\322\302\012\137\156\115\201\270\200\163\154\101\334\247"
	"\110\120\034\364\305\233\320\113\357\273\102\316\310\123\224\254"
	"\364\050\322\026\072\000\216\116\030\151\041\101\232\155\030\073"
	"\370\341\036\074\272\225\225\172\220\344\150\257\353\100\331\266"
	"\163\023\356\336\202\153\004\143\203\002\207\247\061\320\063\304"
	"\032\175\014\246\203\215\072\373\061\331\204\300\123\146\137\101"
	"\106\117\037\076\106\076\336\267\275\113\116\142\145\067\352\361"
	"\040\377\172\365\216\065\266\033\325\127\200\160\002\136\320\261"
	"\315\372\304\231\073\225\371\341\333\111\370\155\072\206\135\323"
	"\031\053\315\247\232\230\351\274\274\015\363\204\113\352\371\300"
	"\012\224\275\055\332\132\045\025\256\214\202\150\170\057\012\370"
	"\101\205\105\337\311\061\044\167\170\230\174\224\020\321\231\373"
	"\322\252\156\054\003\041\327\300\113\201\177\330\036\025\330\372"
	"\263\036\124\246\174\035\157\214\165\314\210\166\115\133\332\137"
	"\014\173\070\173\317\310\022\170\252\045\011\153\155\337\262\034"
	"\232\053\353\314\374\077\036\300\226\277\336\304\064\154\025\304"
	"\245\166\310\077\024\347\203\252\055\113\136\213\222\207\212\164"
	"\172\374\370\333\026\223\031\217\142\330\200\343\360\232\007\147"
	"\205\153\041\157\156\226\065\142\302\342\004\344\073\110\226\241"
	"\135\121\146\260\231\223\145\243\377\036\167\006\377\226\303\223"
	"\112\127\117\106\321\273\007\070\157\360\243\256\123\267\064\264"
	"\343\230\257\312\105\265\136\164\174\314\114\024\302\062\362\037"
	"\346\031\163\324\023\362\003\362\326\047\227\332\146\015\250\222"
	"\304\041\176\127\142\316\332\263\171\322\300\262\016\073\020\264"
	"\260\325\002\225\331\243\111\324\315\344\327\353\342\264\200\314"
	"\003\363\225\001\237\267\232\345\050\335\036\236\004\244\052\265"
	"\215\011\350\327\003\251\136\075\251\124\141\372\034\222\317\272"
	"\253\104\123\112\222\367\354\017\146\163\312\123\040\327\172\223"
	"\214\324\060\320\171\352\140\252\200\234\247\356\073\041\324\251"
	"\135\212\062\253\324\021\243\014\213\013\062\045\362\034\035\226"
	"\213\070\261\032\367\010\054\277\133\355\103\336\024\344\377\341"
	"\123\234\376\062\011\021\010\104\313\146\312\051\325\371\310\322"
	"\231\254\032\120\133\135\320\262\203\066\115\176\156\274\140\341"
	"\343\216\327\337\316\175\265\001\010\067\303\366\336\332\273\022"
	"\327\201\375\330\344\204\130\203\035\154\216\222\243\026\136\071"
	"\142\366\355\153\124\153\104\071\101\226\357\353\135\304\241\152"
	"\142\307\347\330\140\370\067\230\350\334\125\153\065\377\172\261"
	"\061\044\222\374\142\264\130\354\222\045\074\007\166\327\321\175"
	"\204\100\306\057\143\106\122\013\141\225\067\215\055\143\355\361"
	"\363\304\123\215\161\116\163\127\221\274\034\045\111\227\070\071"
	"\270\231\354\066\133\147\243\034\073\374\115\163\201\105\207\342"
	"\004\170\026\262\372\372\143\112\115\070\141\263\064\014\100\221"
	"\325\360\165\225\313\171\166\164\377\262\120\050\307\154\066\314"
	"\062\063\201\305\052\360\315\122\167\262\357\231\145\147\053\137"
	"\023\140\147\250\321\234\276\150\216\153\356\340\172\041\254\044"
	"\134\332\370\051\053\274\146\160\253\117\012\030\021\326\243\237"
	"\260\366\007\140\104\243\214\371\010\142\005\111\342\044\276\101"
	"\002\012\317\374\026\246\012\025\204\200\237\350\054\072\234\370"
	"\263\053\023\350\077\122\210\040\045\323\342\013\147\375\127\066"
	"\012\324\315\231\172\142\343\000\353\026\162\255\131\255\127\332"
	"\047\056\347\102\111\134\306\023\003\112\234\026\133\375\175\305"
	"\326\241\215\204\366\071\034\336\201\322\067\202\046\337\305\322"
	"\266\035\334\301\164\172\361\335\311\350\325\304\321\033\245\124"
	"\020\142\113\230\274\325\342\065\105\155\104\016\115\276\237\346"
	"\042\010\227\060\127\041\200\062\007\023\346\142\221\114\003\323"
	"\275\266\311\232\055\352\234\201\111\306\144\336\103\352\367\027"
	"\027\364\224\254\133\027\130\017\334\347\220\166\311\264\227\026"
	"\176\024\151\223\220\040\141\166\203\171\042\120\161\220\023\205"
	"\237\216\252\313\136\141\163\034\373\037\016\035\162\353\063\366"
	"\120\153\144\247\251\157\104\112\006\161\061\153\141\151\325\255"
	"\005\133\043\115\365\271\213\043\167\117\357\220\123\365\272\156"
	"\356\167\367\357\130\377\272\352\232\345\265\271\366\212\310\162"
	"\277\063\062\037\035\231\110\135\052\351\130\304\201\353\140\135"
	"\012\124\212\066\057\253\024\152\347\247\123\163\222\104\010\156"
	"\200\315\001\342\217\213\370\135\367\322\221\164\371\176\046\337"
	"\316\311\346\120\051\256\213\246\003\154\263\162\200\256\013\222"
	"\321\261\123\336\337\036\377\052\111\376\115\154\134\122\061\120"
	"\203\267\156\045\214\046\060\161\371\153\345\341\174\172\342\050"
	"\045\176\137\047\232\211\100\011\172\373\104\024\227\337\273\222"
	"\311\063\032\354\377\263\052\067\164\271\146\344\032\270\126\362"
	"\030\346\115\141\073\315\357\362\047\220\275\347\326\063\076\252"
	"\046\053\230\230\111\054\040\267\307\310\002\263\232\100\031\020"
	"\067\162\113\204\050\353\310\263\210\365\233\145\160\265\033\127"
	"\310\201\336\155\134\372\120\366\145\132\150\241\215\165\103\142"
	"\337\126\000\366\014\326\300\017\223\234\220\351\011\105\237\022"
	"\270\064\203\250\263\043\122\166\143\067\056\107\216\120\375\100"
	"\362\245\015\026\304\337\322\230\041\241\345\363\054\264\371\244"
	"\157\310\152\054\304\343\322\143\307\076\352\070\334\124\332\106"
	"\212\025\335\044\006\233\217\202\324\336\275\076\140\010\117\244"
	"\041\123\332\246\257\154\031\160\245\324\234\055\323\077\142\372"
	"\000\240\244\221\100\154\056\107\273\176\320\376\200\142\300\334"
	"\025\035\326\372\261\346\162\342\160\311\113\240\220\100\271\164"
	"\375\233\155\373\116\253\276\376\243\074\130\243\372\234\206\304"
	"\015\043\101\172\072\001\106\265\144\057\056\332\074\337\221\220"
	"\260\240\064\337\300\321\066\332\210\261\157\051\322\171\162\040"
	"\202\314\042\123\375\107\123\130\042\302\134\374\357\275\225\250"
	"\170\160\202\347\231\033\316\066\374\075\346\044\363\026\026\324"
	"\170\055\121\002\305\072\132\021\005\235\327\122\015\212\163\036"
	"\161\106\002\326\032\165\012\002\112\321\152\010\240\130\137\340"
	"\152\325\235\111\136\106\016\107\024\035\200\302\241\273\105\311"
	"\273\062\013\016\032\116\100\273\366\167\116\303\057\125\007\022"
	"\353\141\066\344\373\242\205\055\264\122\153\103\324\322\231\230"
	"\055\341\333\167\163\150\210\177\130\340\045\012\034\301\300\042"
	"\333\375\146\047\007\031\006\155\125\015\200\257\114\231\353\122"
	"\367\303\075\377\343\341\236\307\112\361\340\233\004\234\301\341"
	"\021\166\277\300\012\360\346\326\206\074\035\274\150\311\175\030"
	"\262\034\271\270\333\327\237\267\366\150\101\123\002\021\307\201"
	"\241\366\360\174\171\251\140\071\352\316\006\032\066\100\340\023"
	"\074\322\362\132\274\012\322\161\351\357\360\177\276\276\076\000"
	"\337\015\155\012\242\341\071\371\031\273\145\371\157\026\102\166"
	"\241\355\327\357\315\347\320\147\347\167\066\115\253\072\230\126"
	"\213\352\153\117\272\220\121\011\255\237\032\115\074\212\016\205"
	"\341\342\375\104\217\164\161\161\201\153\131\013\176\274\146\003"
	"\042\043\164\362\270\326\134\133\124\112\177\054\043\250\361\041"
	"\127\224\330\367\043\244\344\273\077\345\111\336\061\200\352\131"
	"\353\343\047\031\261\056\107\057\251\021\223\161\160\306\122\220"
	"\366\232\262\033\164\346\227\160\123\235\314\063\253\353\034\356"
	"\237\303\313\274\062\307\045\231\067\150\332\070\203\124\210\153"
	"\103\056\076\372\154\257\262\040\303\177\274\100\321\330\371\021"
	"\203\227\322\316\036\353\372\244\304\071\133\375\017\053\064\361"
	"\005\323\326\242\163\105\060\155\162\170\374\275\317\142\206\023"
	"\041\272\014\222\371\315\103\032\165\241\213\271\110\050\375\222"
	"\156\345\267\020\146\207\321\002\041\215\365\137\016\177\233\107"
	"\253\325\326\276\052\143\350\264\153\041\237\274\371\056\344\254"
	"\052\262\356\312\115\074\303\375\266\101\175\037\220\271\044\231"
	"\355\326\126\224\075\230\312\171\006\236\346\064\044\023\246\023"
	"\265\300\375\304\216\331\326\371\270\071\053\206\266\144\267\217"
	"\175\201\022\041\051\313\066\374\333\150\267\230\174\060\267\261"
	"\305\237\377\042\157\364\126\140\010\206\272\100\335\324\267\313"
	"\172\135\133\320\146\226\242\265\006\151\071\164\337\212\172\227"
	"\134\177\055\051\214\257\253\071\245\341\364\221\213\105\226\036"
	"\335\067\057\253\060\072\067\047\032\001\222\073\162\211\237\353"
	"\043\364\260\073\135\366\325\132\230\025\120\256\361\271\356\233"
	"\025\002\057\124\177\035\357\050\203\044\020\342\252\156\277\243"
	"\243\041\366\156\013\037\311\377\141\340\366\025\033\010\165\103"
	"\230\177\135\207\247\027\023\036\246\064\275\001\152\040\057\165"
	"\125\376\341\334\254\067\003\213\145\162\012\012\304\206\133\367"
	"\376\177\251\261\343\164\373\273\324\307\202\242\035\202\025\043"
	"\344\332\363\203\324\161\135\263\134\114\061\076\362\272\257\360"
	"\272\074\004\317\124\275\360\313\125\134\241\020\143\251\233\004"
	"\005\004\322\220\312\347\044\000\007\032\123\254\156\260\034\362"
	"\327\315\051\124\371\315\276\337\260\360\204\313\150\064\224\314"
	"\222\014\164\172\236\013\015\121\032\144\070\243\200\216\022\242"
	"\303\266\031\233\304\263\035\114\173\014\142\222\244\016\123\374"
	"\136\047\125\346\255\262\100\121\330\361\217\332\256\257\101\144"
	"\036\366\065\271\256\021\314\025\045\026\044\214\015\327\076\320"
	"\031\315\322\351\102\125\253\377\124\267\323\104\170\301\074\053"
	"\167\216\026\316\076\050\025\224\012\074\134\214\357\307\043\204"
	"\276\064\313\110\111\021\236\234\266\143\246\123\313\356\053\311"
	"\365\067\101\065\241\150\304\310\263\152\075\171\233\362\172\266"
	"\076\163\006\014\372\017\066\010\164\201\377\217\043\052\346\276"
	"\351\023\170\344\001\251\076\140\271\150\003\024\362\326\221\234"
	"\262\204\361\255\354\035\324\136\140\040\320\055\230\011\341\047"
	"\265\077\157\005\335\336\030\267\251\012\222\237\240\310\151\013"
	"\007\064\143\226\350\225\075\250\136\311\353\043\062\075\134\331"
	"\126\075\050\074\177\320\257\304\140\323\211\070\036\065\157\363"
	"\065\104\131\073\054\232\172\225\255\140\112\044\374\232\024\315"
	"\107\220\217\146\016\361\234\373\174\367\271\123\344\335\110\311"
	"\101\030\216\366\311\265\350\276\034\233\173\170\031\362\155\205"
	"\370\134\015\220\306\257\056\242\117\221\156\317\066\277\035\035"
	"\064\354\371\201\321\217\066\212\251\043\046\241\335\305\015\121"
	"\073\025\131\050\355\335\077\374\072\350\074\171\020\223\215\163"
	"\324\235\232\140\176\101\163\254\025\177\324\247\243\156\302\011"
	"\275\064\322\275\360\030\043\012\130\151\250\126\333\304\125\306"
	"\125\066\030\164\204\310\117\273\174\232\003\167\374\124\065\153"
	"\333\105\215\120\255\347\230\367\014\017\014\236\376\360\347\070"
	"\332\172\127\075\100\063\340\142\171\202\006\304\050\024\137\255"
	"\344\067\347\244\062\271\232\204\233\265\275\306\330\334\227\141"
	"\102\224\307\030\070\322\163\352\376\266\251\352\204\072\272\256"
	"\054\071\015\315\127\347\264\054\215\040\271\261\266\223\117\004"
	"\033\375\052\345\334\370\045\170\320\241\104\065\202\066\015\004"
	"\251\276\312\042\332\231\062\045\331\152\353\214\010\230\051\253"
	"\000\037\025\364\202\171\230\037\277\245\267\367\004\323\157\336"
	"\214\014\005\236\164\074\032\164\244\063\017\012\221\037\310\141"
	"\267\347\374\105\123\216\364\352\273\111\123\131\234\064\356\202"
	"\260\306\133\375\367\222\266\266\110\150\333\316\010\154\126\242"
	"\341\335\173\210\023\210\014\210\203\161\370\060\337\221\240\156"
	"\073\235\015\337\010\251\202\373\235\207\236\033\347\061\075\237"
	"\042\231\311\046\335\200\113\022\074\366\302\100\210\160\174\013"
	"\254\126\031\252\320\265\171\117\374\025\203\015\356\136\114\320"
	"\304\363\337\205\127\302\266\026\257\164\310\067\207\322\174\341"
	"\073\355\141\103\255\030\304\060\032\106\051\311\333\034\164\207"
	"\301\125\006\164\100\315\023\024\133\376\364\013\365\356\105\215"
	"\042\226\143\164\265\052\141\111\341\042\354\020\027\030\143\054"
	"\275\331\227\331\143\063\135\131\314\241\074\237\126\126\356\316"
	"\347\366\234\250\042\232\266\005\053\065\174\036\245\153\213\112"
	"\015\104\237\142\067\135\135\217\000\251\370\244\304\154\343\233"
	"\340\103\240\244\225\054\176\251\270\075\170\234\364\003\037\332"
	"\317\040\240\252\334\115\104\057\155\125\007\264\114\214\377\142"
	"\043\324\035\042\157\156\125\060\253\244\137\152\335\226\044\305"
	"\063\327\007\060\161\240\012\314\137\124\310\157\376\036\114\356"
	"\216\036\047\357\254\326\160\147\227\326\332\132\175\306\264\247"
	"\110\214\164\172\200\026\356\044\106\214\366\331\302\160\142\205"
	"\120\235\127\077\176\342\105\337\027\022\131\166\233\363\016\356"
	"\053\304\066\174\120\306\163\270\333\105\323\016\150\020\245\007"
	"\362\231\004\054\306\004\031\333\246\265\352\117\007\163\156\214"
	"\171\254\223\004\331\047\347\220\076\146\016\133\075\140\244\352"
	"\011\141\342\004\232\017\342\270\107\371\130\262\326\176\231\313"
	"\120\035\313\227\116\344\260\037\107\323\345\031\052\227\266\163"
	"\155\234\360\206\313\223\362\145\012\114\354\111\077\162\146\022"
	"\266\250\037\044\262\175\146\346\020\230\140\167\203\070\106\377"
	"\063\370\371\107\130\326\341\152\320\252\043\057\240\373\162\143"
	"\332\200\103\165\322\117\101\304\021\324\174\373\177\012\041\014"
	"\041\347\141\021\276\137\042\052\210\224\001\121\100\131\376\000"
	"\160\235\032\303\277\173\331\244\266\052\335\074\244\043\255\050"
	"\331\366\167\101\054\265\332\106\371\162\140\124\333\041\253\267"
	"\223\216\057\307\061\337\045\133\370\332\055\062\151\157\072\250"
	"\066\247\247\111\173\267\216\157\117\207\271\034\242\316\303\330"
	"\344\252\051\360\325\226\130\054\100\173\226\277\305\103\057\362"
	"\120\020\042\027\251\132\067\074\033\224\067\121\333\164\273\066"
	"\274\137\274\374\131\124\023\022\102\301\351\325\052\123\001\122"
	"\332\377\352\131\203\156\221\263\105\156\221\024\305\044\162\016"
	"\042\066\027\374\233\322\261\310\106\047\040\342\066\045\004\266"
	"\336\071\010\352\241\116\026\206\152\240\220\055\373\367\072\241"
	"\065\321\057\026\121\141\005\114\304\200\250\032\236\024\122\235"
	"\024\272\135\337\076\113\257\363\152\077\063\223\261\000\213\256"
	"\125\023\054\302\166\164\220\224\133\061\200\011\002\243\021\000"
	"\066\371\317\223\320\313\236\132\352\027\011\071\215\124\104\176"
	"\111\064\315\320\015\205\176\266\230\346\254\052\065\360\224\126"
	"\375\122\243\033\016\252\200\272\174\072\174\320\015\101\004\035"
	"\247\334\217\240\022\371\216\241\251\164\041\267\110\242\001\254"
	"\077\376\126\100\006\061\326\150\303\054\345\167\307\040\022\262"
	"\307\013\035\032\331\174\162\366\225\347\311\265\137\320\146\162"
	"\147\175\302\307\072\162\231\123\260\214\025\066\372\375\133\125"
	"\240\013\354\301\334\114\010\277\345\153\223\164\300\273\154\057"
	"\055\245\175\251\161\214\264\271\212\131\304\134\266\132\342\071"
	"\126\170\265\065\321\325\017\174\221\107\217\222\143\074\136\173"
	"\161\321\032\363\026\012\233\140\102\171\316\175\153\332\225\127"
	"\000\013\143\165\360\376\056\010\066\176\164\003\267\147\150\352"
	"\274\056\052\001\301\233\105\353\241\045\234\003\055\121\273\301"
	"\103\071\171\017\217\057\326\124\164\150\324\047\251\220\145\060"
	"\353\313\055\162\277\251\053\106\100\270\357\267\104\037\032\004"
	"\202\022\130\254\175\200\167\261\151\123\124\255\311\150\362\267"
	"\302\156\217\206\115\341\201\347\164\124\165\173\216\320\165\000"
	"\044\064\266\241\105\100\072\311\371\014\205\355\334\202\233\335"
	"\254\141\245\202\122\146\170\370\360\225\022\123\145\027\230\310"
	"\252\254\325\165\374\306\377\101\210\026\240\170\155\315\124\005"
	"\231\000\230\040\013\211\217\324\310\347\104\204\244\327\302\101"
	"\335\237\037\230\264\355\200\243\103\121\034\371\245\010\354\042"
	"\156\244\046\132\312\066\114\125\317\377\133\001\164\246\320\163"
	"\335\117\211\076\010\265\065\314\357\351\161\001\011\117\360\026"
	"\374\065\040\104\121\171\127\241\017\045\355\237\321\000\253\110"
	"\213\231\040\010\017\237\030\151\326\243\234\312\171\032\264\257"
	"\310\100\330\063\063\105\040\206\225\260\373\111\367\206\135\357"
	"\340\201\366\214\250\235\202\203\117\073\137\244\066\123\160\132"
	"\103\365\035\370\303\246\352\344\010\000\160\122\023\253\032\115"
	"\170\164\230\304\257\023\111\133\236\012\114\001\053\373\211\040"
	"\332\162\250\214\356\337\310\006\051\105\075\304\141\146\216\364"
	"\160\351\217\053\206\117\326\350\056\046\363\261\145\321\012\155"
	"\176\145\275\056\132\005\041\330\300\077\102\366\306\264\013\125"
	"\165\143\133\270\154\306\332\235\071\032\015\005\160\104\142\113"
	"\255\220\321\075\064\310\014\233\210\375\161\143\220\312\230\042"
	"\310\233\176\037\303\332\266\037\221\022\175\042\246\230\106\230"
	"\301\104\246\166\021\116\160\314\177\206\143\107\074\130\027\303"
	"\300\203\172\026\002\132\225\014\174\076\203\347\173\362\102\062"
	"\024\127\043\157\347\322\034\220\065\114\332\374\065\251\204\055"
	"\111\045\306\355\167\141\172\304\167\260\144\022\075\062\233\253"
	"\346\245\332\221\066\212\141\277\333\253\205\024\370\002\106\224"
	"\112\003\156\144\142\122\041\312\257\202\300\135\320\226\376\176"
	"\363\003\355\117\132\236\314\264\132\003\013\354\372\042\134\212"
	"\354\240\252\223\272\052\264\003\154\372\321\225\015\222\043\114"
	"\356\062\325\232\013\054\121\015\107\240\070\114\014\146\245\127"
	"\155\135\054\047\065\275\154\063\324\253\300\344\134\117\013\165"
	"\373\327\046\132\011\231\015\063\115\115\117\207\064\032\211\061"
	"\032\046\236\111\304\310\276\372\143\017\107\103\217\373\227\325"
	"\233\271\222\121\034\323\001\164\135\210\145\272\266\026\171\276"
	"\146\032\262\141\152\226\271\123\240\340\206\237\126\320\212\320"
	"\075\217\226\347\263\003\367\013\135\166\002\054\272\010\070\361"
	"\171\135\226\237\012\265\075\156\311\352\071\050\300\045\227\156"
	"\123\277\151\344\013\235\114\321\027\021\111\241\240\002\137\040"
	"\253\275\057\303\207\304\033\130\240\126\100\265\211\163\226\055"
	"\146\071\010\012\265\032\217\343\130\234\263\272\100\030\231\126"
	"\327\244\155\350\055\211\220\165\135\244\223\161\221\316\162\327"
	"\247\337\363\175\035\312\204\135\371\361\171\253\013\115\142\141"
	"\244\071\214\314\124\247\045\377\205\036\335\062\023\014\210\256"
	"\333\024\253\122\234\063\076\377\205\024\362\312\274\155\276\332"
	"\014\120\036\251\222\237\050\162\075\157\156\016\360\251\222\110"
	"\130\076\371\116\265\003\215\274\342\271\055\306\335\017\355\140"
	"\252\147\005\130\307\100\163\060\022\155\007\153\207\204\011\020"
	"\042\236\120\125\175\150\372\351\120\170\225\135\130\323\237\314"
	"\360\130\275\163\070\353\111\041\111\171\075\205\017\371\102\372"
	"\365\153\316\302\236\267\276\222\357\217\226\240\037\115\073\154"
	"\260\302\012\175\141\315\363\042\003\270\375\075\157\174\067\121"
	"\312\044\331\243\327\147\002\172\176\151\007\026\055\031\125\037"
	"\020\354\152\152\221\103\327\000\203\361\230\053\210\060\327\070"
	"\130\373\154\040\043\350\121\171\166\071\141\104\141\031\243\341"
	"\331\251\162\126\117\300\254\014\254\254\274\372\127\062\201\053"
	"\135\145\142\074\102\366\143\103\211\372\225\152\275\235\015\301"
	"\066\064\134\277\127\005\133\020\243\025\353\371\055\150\276\201"
	"\014\212\043\352\371\307\300\371\113\211\221\346\353\252\065\213"
	"\023\352\003\251\136\010\207\161\363\174\104\072\047\256\062\266"
	"\145\033\102\357\174\314\004\274\273\017\012\234\003\031\304\016"
	"\362\120\171\233\245\173\217\365\274\154\214\036\321\136\263\104"
	"\351\013\052\323\213\035\351\001\043\116\010\277\346\036\233\044"
	"\151\207\357\012\021\012\054\202\154\231\365\037\336\057\145\040"
	"\024\147\007\371\262\241\215\160\067\255\106\323\100\340\327\015"
	"\251\141\073\246\020\370\034\235\044\100\234\025\373\312\135\117"
	"\066\234\176\247\057\226\025\052\253\360\172\346\306\026\267\105"
	"\207\060\041\273\005\145\162\337\353\321\127\334\373\056\023\360"
	"\161\253\164\120\274\211\063\365\222\226\207\224\372\314\216\356"
	"\041\007\363\054\320\372\374\323\254\007\070\232\144\106\370\134"
	"\365\074\300\246\054\345\300\357\251\325\031\072\276\145\137\245"
	"\332\247\111\326\017\060\300\312\222\345\162\156\224\330\162\164"
	"\204\267\244\214\222\222\375\117\013\017\327\153\232\317\042\230"
	"\170\213\232\375\142\010\146\356\306\105\151\244\167\270\174\375"
	"\341\352\314\003\265\361\215\334\214\155\030\157\210\272\030\320"
	"\062\215\231\061\140\030\352\063\351\334\116\063\226\117\252\144"
	"\264\302\226\027\207\100\247\201\023\026\363\307\006\316\164\240"
	"\323\111\100\275\250\254\076\351\355\122\207\141\365\202\037\064"
	"\166\304\271\103\256\324\260\072\210\234\232\346\176\362\320\247"
	"\034\264\321\000\115\354\123\146\204\011\011\054\130\046\316\055"
	"\066\122\320\251\073\363\172\162\064\376\003\066\204\045\176\301"
	"\207\162\041\041\202\026\317\367\200\077\103\233\205\104\255\152"
	"\204\306\312\032\172\150\027\031\322\011\357\273\162\313\116\266"
	"\335\021\161\017\337\105\144\276\346\276\001\054\012\255\216\336"
	"\325\142\032\203\175\356\141\267\044\061\234\371\152\354\305\061"
	"\233\073\005\063\356\320\024\332\235\126\350\253\377\123\100\110"
	"\132\354\043\143\064\017\032\234\301\330\277\136\154\225\220\353"
	"\154\375\056\363\277\077\030\176\255\005\027\275\360\003\327\341"
	"\311\045\312\153\046\376\273\075\065\224\024\070\040\104\164\102"
	"\203\343\326\051\017\227\277\335\216\042\070\200\203\164\146\161"
	"\143\057\053\320\364\115\256\115\123\010\001\024\144\207\015\170"
	"\301\130\060\250\160\146\147\303\262\234\252\047\237\341\243\057"
	"\325\024\365\215\040\074\323\010\253\323\157\065\135\244\374\002"
	"\113\000\016\326\105\044\070\010\065\333\371\312\116\006\316\207"
	"\052\163\345\030\220\314\102\150\026\275\014\021\024\112\133\145"
	"\220\074\147\133\204\054\301\051\127\057\013\346\366\326\252\166"
	"\341\151\374\327\255\374\024\233\030\223\201\031\212\312\073\335"
	"\124\322\143\105\177\250\065\363\235\322\165\103\022\054\040\323"
	"\300\353\121\131\205\266\263\022\134\222\006\340\305\216\305\330"
	"\342\173\065\051\364\110\367\364\220\172\224\005\334\103\374\111"
	"\134\044\330\054\146\131\366\017\220\047\324\231\063\336\301\247"
	"\324\203\243\212\325\306\246\074\276\220\335\225\316\266\017\226"
	"\161\317\313\064\215\062\064\153\222\373\351\303\056\376\375\054"
	"\110\124\354\342\324\073\323\200\100\341\111\325\040\255\377\371"
	"\315\156\007\042\315\245\260\020\251\031\001\234\020\157\233\067"
	"\223\163\152\217\111\066\221\050\056\336\037\312\363\112\003\120"
	"\305\116\355\057\321\011\351\023\016\277\334\320\126\263\140\064"
	"\041\144\200\105\317\162\300\036\201\336\203\277\126\352\244\112"
	"\140\034\310\063\114\150\057\205\320\145\265\262\004\377\377\121"
	"\273\332\371\347\361\040\112\254\115\266\323\336\163\012\140\351"
	"\361\023\216\305\346\241\062\003\136\226\152\177\013\170\366\124"
	"\111\350\222\057\124\231\304\067\316\300\340\331\165\157\026\144"
	"\351\006\347\127\327\131\141\140\356\152\041\233\142\330\214\127"
	"\122\320\224\332\215\370\217\215\042\310\370\062\011\174\233\111"
	"\204\061\220\303\332\324\102\004\276\075\026\166\217\347\346\220"
	"\052\331\200\307\221\042\377\106\114\145\130\135\104\362\262\345"
	"\144\315\070\215\013\127\313\377\306\241\345\133\171\052\065\333"
	"\301\333\075\245\150\024\267\102\026\351\233\303\132\235\334\376"
	"\254\043\342\272\242\154\205\152\150\141\203\203\207\354\321\033"
	"\375\212\156\173\041\302\044\152\270\206\011\167\346\161\131\302"
	"\133\123\155\231\123\051\327\344\305\050\112\214\346\145\022\127"
	"\046\226\175\233\142\102\143\152\111\146\143\265\057\207\102\142"
	"\245\315\274\135\142\017\354\071\040\273\066\133\246\137\270\325"
	"\034\167\350\131\106\375\152\335\020\227\133\316\325\352\360\141"
	"\040\004\302\054\360\202\251\037\033\075\200\110\015\254\001\022"
	"\166\123\315\116\024\031\367\242\001\074\030\304\223\332\050\077"
	"\071\237\026\044\121\015\261\104\347\227\131\113\132\003\131\146"
	"\213\040\042\140\005\112\337\174\013\165\000\163\235\060\350\046"
	"\147\111\042\015\360\252\312\116\275\051\214\241\210\211\072\115"
	"\275\164\162\310\357\174\220\135\261\321\007\243\161\131\361\260"
	"\102\240\021\237\135\142\264\335\164\101\135\304\034\105\305\214"
	"\355\000\147\175\234\071\124\104\114\267\007\312\017\062\054\246"
	"\322\016\364\135\020\050\170\310\202\132\335\237\150\032\127\103"
	"\204\014\162\127\342\212\016\220\345\333\065\141\125\205\036\011"
	"\352\201\105\254\361\164\210\322\375\317\302\320\332\352\273\151"
	"\153\004\275\061\374\151\347\254\267\315\264\165\344\201\161\223"
	"\136\045\267\021\067\327\256\146\320\367\107\330\346\070\004\275"
	"\065\253\027\341\131\314\326\321\265\215\307\074\075\207\253\200"
	"\256\177\335\047\217\146\135\155\025\057\056\013\017\323\036\235"
	"\372\031\111\373\152\360\114\235\370\134\044\141\314\320\315\304"
	"\044\127\160\346\357\265\312\105\332\065\002\034\272\232\010\004"
	"\346\343\066\232\340\104\152\073\056\041\341\104\240\243\240\271"
	"\225\237\240\213\225\300\042\223\012\056\272\254\047\073\027\017"
	"\227\300\027\115\033\334\264\143\153\140\023\320\023\014\170\155"
	"\164\114\101\357\175\044\371\000\245\207\131\011\051\220\304\307"
	"\170\152\104\144\214\314\305\210\031\130\254\231\040\370\351\120"
	"\031\001\255\140\062\363\137\007\246\302\005\111\350\013\320\071"
	"\314\044\172\033\010\030\374\020\231\045\367\342\100\144\223\035"
	"\047\077\244\314\026\377\300\254\067\365\242\110\370\376\164\361"
	"\145\244\171\025\262\366\332\231\165\365\364\353\267\327\210\373"
	"\173\061\132\312\250\164\011\202\211\034\100\216\262\271\246\337"
	"\176\150\334\347\054\253\214\064\202\220\162\153\077\202\211\176"
	"\110\325\144\234\001\266\014\344\173\112\345\016\143\341\307\102"
	"\203\133\213\044\170\021\065\130\144\031\013\314\024\231\162\036"
	"\216\167\270\221\337\171\201\332\016\317\171\012\365\214\046\003"
	"\066\063\300\263\161\155\263\055\126\347\004\272\000\201\160\320"
	"\360\004\011\023\063\340\333\064\213\160\233\176\036\321\160\365"
	"\165\016\107\210\055\125\100\040\124\065\166\277\162\242\224\061"
	"\145\314\076\071\162\033\043\272\122\254\244\221\123\311\265\107"
	"\030\265\024\002\027\113\221\364\010\162\006\201\172\160\344\331"
	"\320\004\317\063\036\135\141\025\046\130\357\170\112\237\220\044"
	"\077\323\157\115\121\133\304\052\147\251\065\053\061\173\102\025"
	"\163\232\223\002\132\043\000\200\107\032\176\154\110\007\244\336"
	"\344\303\221\270\075\336\331\103\204\021\322\306\315\110\155\273"
	"\103\214\242\365\063\302\370\222\171\370\116\074\024\154\250\125"
	"\106\203\241\144\366\004\255\151\014\241\226\063\241\074\370\143"
	"\213\356\371\303\263\002\176\033\213\070\043\006\116\225\316\100"
	"\126\375\020\000\260\312\306\221\030\016\116\013\200\374\263\106"
	"\041\353\200\223\174\011\052\275\131\226\072\025\072\151\333\067"
	"\026\266\054\357\016\024\102\046\055\127\203\232\322\362\270\053"
	"\141\313\360\025\361\163\241\230\306\272\365\334\206\212\053\027"
	"\250\001\304\053\267\172\125\114\036\200\102\263\306\104\145\270"
	"\374\035\314\201\034\211\145\376\031\303\221\364\171\154\072\172"
	"\107\164\346\223\167\036\335\002\367\126\124\055\067\233\073\261"
	"\212\014\132\067\112\233\255\063\144\023\217\345\320\162\230\211"
	"\160\217\064\336\041\031\014\126\260\256\115\277\301\232\021\230"
	"\214\223\110\373\365\107\377\212\072\315\263\223\322\166\334\240"
	"\074\140\132\235\011\251\116\353\267\203\047\316\027\021\315\314"
	"\144\047\156\230\160\252\172\244\225\071\037\005\263\121\307\347"
	"\327\266\036\233\170\155\375\356\241\263\153\017\303\306\344\331"
	"\353\075\163\044\017\256\316\236\240\226\260\255\010\147\116\340"
	"\233\304\000\057\302\271\103\325\132\101\324\146\055\104\027\164"
	"\124\317\211\053\271\333\250\112\007\366\277\033\173\125\063\065"
	"\355\250\022\104\175\042\015\274\370\234\127\102\243\206\243\103"
	"\156\247\120\237\125\261\263\042\254\355\260\360\330\256\236\343"
	"\262\312\000\352\307\312\231\210\226\050\320\315\115\350\340\311"
	"\232\315\121\155\023\174\034\100\012\125\331\351\150\253\173\101"
	"\205\121\075\046\151\255\235\202\115\357\226\214\137\205\013\355"
	"\236\346\104\065\145\271\277\235\311\357\026\345\116\277\212\024"
	"\125\050\345\021\321\004\077\275\235\146\007\233\242\200\245\017"
	"\056\162\256\066\161\107\026\026\026\164\140\047\004\267\045\343"
	"\073\141\205\034\336\010"
#define      msg1_z	65
#define      msg1	((&data[7716]))
	"\201\062\214\151\333\326\374\333\261\271\070\177\003\215\377\125"
	"\050\310\120\164\165\051\002\100\204\013\314\074\051\206\101\015"
	"\042\115\162\264\161\351\364\063\317\247\164\056\240\066\274\154"
	"\342\044\307\113\224\165\203\227\100\014\050\256\053\321\365\331"
	"\153\300"
#define      tst2_z	19
#define      tst2	((&data[7783]))
	"\153\242\251\377\122\036\132\156\032\374\062\116\210\101\025\100"
	"\066\147\013\156"
#define      chk2_z	19
#define      chk2	((&data[7805]))
	"\145\267\353\266\143\066\050\323\140\337\373\034\116\067\057\264"
	"\151\122\054\141\113\037\324\111\166"
#define      tst1_z	22
#define      tst1	((&data[7832]))
	"\252\235\246\376\110\057\027\077\301\066\116\024\242\205\162\030"
	"\337\245\322\035\363\164\121\223\070\136\217\040\274\120"
#define      rlax_z	1
#define      rlax	((&data[7857]))
	"\032"
#define      date_z	1
#define      date	((&data[7858]))
	"\031"
#define      chk1_z	22
#define      chk1	((&data[7863]))
	"\355\306\174\173\226\163\011\212\215\123\242\057\044\203\052\375"
	"\154\347\332\042\266\220\255\313\355\052\344\251\342\364"
#define      msg2_z	19
#define      msg2	((&data[7891]))
	"\364\243\156\200\347\123\201\225\037\242\036\365\216\071\053\241"
	"\376\100\023\343\161\065"
#define      opts_z	1
#define      opts	((&data[7911]))
	"\261"
#define      shll_z	10
#define      shll	((&data[7913]))
	"\107\310\226\104\164\042\163\252\212\125\316\263\020"
#define      xecc_z	15
#define      xecc	((&data[7928]))
	"\006\344\075\053\244\111\114\136\301\270\150\317\040\340\326\067"
	"\106\172\170"
#define      inlo_z	3
#define      inlo	((&data[7944]))
	"\372\115\213"
#define      lsto_z	1
#define      lsto	((&data[7947]))
	"\141"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
